<div class="h-full flex flex-col space-y-6 animate-fade-in">
  <header>
    <h1 class="text-3xl font-bold text-gray-900">ูุณุงุญุฉ ุนูู ุงูุตุญูู</h1>
    <p class="text-gray-500 mt-1">ุจูุฆุฉ ุนูู ููุชุฑููุฒ ูุงูุฅูุชุงุฌุ ูุนุฒุฒุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู.</p>
  </header>

  <div class="flex-grow grid grid-cols-1 lg:grid-cols-2 gap-6 min-h-0">
    <!-- AI Assistant -->
    <div class="bg-base-100 rounded-xl shadow-lg flex flex-col h-[70vh] lg:h-auto">
      <h2 class="text-xl font-bold text-gray-800 p-4 border-b border-gray-200 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 21v-1.5M15.75 3v1.5m0 15v-1.5M12 4.5v-1.5m0 18v-1.5" /> <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 18.75h3M10.5 5.25h3M12 21a9 9 0 1 1 0-18 9 9 0 0 1 0 18Z" /></svg>
        <span>ุงููุณุงุนุฏ ุงูุฐูู (YemenGPT)</span>
      </h2>
      <div class="flex-grow overflow-y-auto p-4 space-y-4">
        @for(message of messages(); track message.id) {
          <div class="flex items-end gap-2" [class.justify-end]="message.from === 'user'" [class.flex-row-reverse]="message.from === 'user'">
            <div class="p-3 rounded-lg max-w-md" [class]="message.from === 'user' ? 'bg-ph-blue text-white rounded-t-xl rounded-s-xl' : 'bg-base-300 rounded-t-xl rounded-e-xl'">
              <p>{{ message.text }}</p>
            </div>
          </div>
        }
        @if(isTyping()) {
          <div class="flex">
            <div class="p-3 rounded-t-xl rounded-e-xl bg-base-300">
              <div class="flex items-center space-i-2">
                <span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse"></span>
                <span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:0.2s]"></span>
                <span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:0.4s]"></span>
              </div>
            </div>
          </div>
        }
      </div>
      <form (submit)="handleSend($event)" class="p-4 border-t border-gray-200">
        <div class="flex items-center">
          <input type="text" placeholder="ุงุณุฃู ุฃู ุดูุก..." class="flex-grow p-2 rounded-s-lg border border-gray-300 bg-gray-50 text-gray-900 focus:ring-ph-yellow focus:border-ph-yellow">
          <button type="submit" class="p-2 bg-ph-blue text-white rounded-e-lg hover:bg-ph-blue-dark">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" /></svg>
          </button>
        </div>
      </form>
    </div>

    <!-- IndiLab Alerts -->
    <div class="bg-base-100 rounded-xl shadow-lg flex flex-col h-[70vh] lg:h-auto">
      <h2 class="text-xl font-bold text-ph-yellow p-4 border-b border-gray-200">๐จ ุงูุฅูุฐุงุฑ ุงููุจูุฑ (IndiLab)</h2>
      <div class="flex-grow overflow-y-auto p-4 space-y-3">
        @for (alert of alerts(); track alert.id) {
          <div class="bg-base-200 p-3 rounded-lg border-s-4 border-ph-yellow/50">
            <p class="text-sm text-gray-700">{{ alert.text }}</p>
            <p class="text-xs text-gray-500 text-left mt-1">{{ alert.timestamp }}</p>
          </div>
        }
      </div>
    </div>

    <!-- My Investigations -->
    <div class="lg:col-span-2 bg-base-100 p-6 rounded-xl shadow-lg">
      <h2 class="text-xl font-bold text-gray-800 mb-4">ุชุญูููุงุชู</h2>
      <div class="space-y-3">
        @for (inv of investigations(); track inv.id) {
          <div class="bg-base-200 hover:bg-gray-200 p-4 rounded-lg flex justify-between items-center transition-colors cursor-pointer">
            <div>
              <p class="font-semibold text-gray-900">{{ inv.title }}</p>
              <p class="text-xs text-gray-500">ุขุฎุฑ ุชุญุฏูุซ: {{ inv.lastUpdated }}</p>
            </div>
            <span class="text-xs font-bold px-3 py-1 rounded-full"
              [ngClass]="{
                'bg-yellow-500/20 text-yellow-500': inv.status === 'ููุฏ ุงููุฑุงุฌุนุฉ',
                'bg-blue-500/20 text-blue-400': inv.status === 'ูุณูุฏุฉ',
                'bg-green-500/20 text-green-400': inv.status === 'ููุดุฑ'
              }">
              {{ inv.status }}
            </span>
          </div>
        } @empty {
          <p class="text-center text-gray-500 py-8">ูุง ุชูุฌุฏ ุชุญูููุงุช ุญุงููุฉ. ุงุจุฏุฃ ุชุญูููุงู ุฌุฏูุฏุงู!</p>
        }
      </div>
    </div>
  </div>
</div>